---
argument-hint: [error-message]
description: エラー・挙動不良等、問題の原因を特定するための調査専用コマンド
---

# investigating-error - 原因調査専用コマンド

## 目的

エラーメッセージ・ユーザーの指摘から原因を特定し、事実に基づく分析結果を提供するコマンド。
エラーの解消は行わず、原因特定と調査のみに専念する（対応は`/execute`コマンドで実施）。

## 基本方針

- **ログファースト**: 推測ではなく、ログを一次情報として最優先で確認・分析を行い原因特定
- **周辺コードの確認**: 怪しいコードも、周辺ファイルの同様な実装を見ると同様な可能性もある。この場合は別に原因がある可能性も考慮
- **体系的調査**: エラーの発生経路を時系列・処理順序により追跡
- **非忖度**: ユーザーの想定に寄り添わず、事実に基づく冷静な分析
- **読み取り専用**: ファイルの変更・作成・削除は行わない

## 入力

エラーメッセージなど: $ARGUMENTS

## 実行手順

### 1. エラーメッセージの解析

- エラータイプの特定（構文エラー、実行時エラー、論理エラー等）
- エラー発生箇所の特定（ファイル名、行番号、関数名）
- スタックトレースの解析
- タイムスタンプの確認

### 2. ログの調査（最重要）

**ログファイルの探索と確認:**

- アプリケーションログの確認

  - `!ls -la logs/ 2>/dev/null || ls -la *.log 2>/dev/null`
  - `!tail -n 100 [relevant-log-file]`
  - `!grep -i error [log-files]`

- システムログの確認（必要に応じて）

  - `!journalctl -xe --no-pager -n 50` (Linux)
  - `!tail -n 100 /var/log/system.log` (macOS)

- エラー前後のログコンテキスト確認
  - エラー発生前の処理フロー
  - エラー発生時の詳細情報
  - エラー後の影響範囲

### 3. コード調査

使用ツール（読み取り専用）:

- `Read`: エラー発生箇所のコード確認
- `Grep`: エラー関連パターンの検索
- `Glob`: 関連ファイルの探索
- `LS`: プロジェクト構造の確認
- `context7`: フレームワーク・ライブラリのドキュメント確認（利用可能な場合、積極利用）
- `serena`: セマンティック検索、LSP検索（効率的な調査のために積極利用）
- `playwrite`: ブラウザ操作、Devtoolsのエラー内容確認、ページの表示、レイアウトの確認（利用可能な場合、積極利用）

**調査項目:**

- エラー発生箇所のコード詳細
- 関連する依存関係とインポート
- 設定ファイルの内容
- 環境変数の使用状況
- 最近の変更履歴（gitログから）

### 4. 環境調査

- 実行環境の確認

  - OS、ランタイムバージョン
  - 依存パッケージのバージョン
  - 環境変数の設定状況

- リソース状況（必要に応じて）
  - ディスク容量
  - メモリ使用状況
  - ネットワーク接続状態

### 5. 調査結果の提供

**出力構成:**

#### 概要（一例、調査していない結果は出力しなくて良い）

- **報告の概要**
- **報告に関する調査結果の概要**

#### 📝 ログ分析結果

- **主要ログ情報**:
  - [ログファイルから抽出した重要な情報]
  - [エラー前後のコンテキスト]
  - [関連するWarningやInfo]

#### 🔍 コード調査結果

- **問題のあるコード箇所**:
  - [該当コードの引用]
  - [問題点の指摘]

#### 🎯 原因特定

- **直接的原因**: [ログとコードから特定した直接的な原因]
- **根本原因**: [より深層的な原因（設計、設定、環境等）]
- **発生条件**: [エラーが発生する具体的な条件]

#### 📊 調査指標

- **信頼度**: [0-100] 原因特定の確実性
- **ログ活用度**: [0-100] ログ情報の活用レベル
- **忖度回避度**: [0-100] 事実ベース判断の客観性

#### 🔗 関連情報

- 影響範囲: [このエラーが影響する機能や処理]
- 類似エラー: [過去の類似ケースやパターン]

#### 💡 対応方針（実装は行わない）

1. [推奨される修正方法]
2. [代替アプローチ]
3. [予防策]

#### ⚠️ 追加調査が必要な項目

- [不明確な点や追加で確認が必要な事項]

## 重要な制約

- ファイルの編集・作成・削除は絶対に行わない
- エラーの修正や実装は行わない（調査と分析のみ）
- **ログを最優先の情報源として活用**
- 不明な点は正直に報告し、追加調査の必要性を明示
- ユーザーの推測や想定を鵜呑みにせず、事実から判断
- 謝罪ではなく、事実に基づく調査結果を提供

**最重要**

- 必ず問題の報告を出力するのが目的ではなく、正しい問題の特定を行うのがあなたの目的。このため問題が特定できない場合に、こじつけな原因報告や無理な推測を行わないこと。
- 問題が特定できない場合は、その点を報告して次のステップに進むか確認を行うこと
  - 次のステップとは、処理順序に応じて通し番号を記載してログ出力を行うこと
  - その上で動作検証して、問題の特定を行う

## パラメータ

- `$ARGUMENTS`: エラーメッセージ（必須）
